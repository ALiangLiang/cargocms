var COMMON = {
  DOUBLE_CLICK_TIME_PERIOD: 250,
  DEFAULT_INDEX: -1,
  DEFAULT_AVATAR: "/assets/admin/img/avatars/default.png",
};

var itemBeforeEdit = {};
var prefix = 'admin/';
var modelName = "searchpecker";
var appModel = {
  modelName: modelName,
  prefix: prefix,
  data: {
    item: {
      keywords: '',
      crawlerAgent: '',
      reportHtml: '',
      reportImage: '',
      pageNo: 0,
      pageNoPrev: 0,
      pageNoWarn: 0,
      targetUrl: '',
      searchEngine: '',

    },
    items: [],
    option: {}
  },
  view: {
    table: {
      selectIndex: COMMON.DEFAULT_INDEX,
    },
  }
}

/* TABLETOOLS */

<%- include ../default/vue.ejs %>
// 需要新增函式可以對 appMain 進行定義，如：
// appMain.log = function () {console.log("123")}

appMain.editDisabled = function(){
  $('label.fn-edit-disabled > input').attr('disabled', true);
  $('label.fn-edit-disabled').addClass('state-disabled');
};

appMain.createHide = function () {
  $('.fn-create-hide').hide();
};

appMain.DataTableInitComplete = function() {
  var exportBtn = '<a class="DTTT_button DTTT_button_text" id="ToolTables_main-table_custom_0" title="匯出資料" tabindex="0" aria-controls="main-table"><span>匯出</span></a>'
  $(exportBtn).prependTo('.DTTT_container');
  $('#ToolTables_main-table_custom_0').on('click', function() {
    var download = function(url, data, id) {
      $.post( url, data)
      .done(function( result ) {
        $('<iframe>', { id: id, src: '/api/admin/download?fileName=' + result.data }).hide().appendTo('body');
      })
      .fail(function( result ) {
        console.log(result);
      });
    }
    $.SmartMessageBox({
      title : "匯出",
      content: "繪出關鍵字資料",
      buttons : "[取消][匯出 PDF][匯出 EXCEL][匯出 CSV]"
    }, function(ButtonPress) {
      // if(ButtonPress === '匯出配方製作表') {
      //   // download('/api/admin/' + modelName + '/export', serialize(appModel.pagingQuery), 'export');
      //   download('/api/admin/' + modelName + '/exportExcel', serialize(appModel.pagingQuery), 'exportExcel');
      // } else if (ButtonPress === '匯出地址寄送表') {
      //   // download('/api/admin/' + modelName + '/exportSend', serialize(appModel.pagingQuery), 'exportSend');
      //   download('/api/admin/' + modelName + '/exportSendExcel', serialize(appModel.pagingQuery), 'exportSendExcel');
      // } else if (ButtonPress === '匯出兩種格式') {
      //   // download('/api/admin/' + modelName + '/exportSend', serialize(appModel.pagingQuery), 'exportSend');
      //   // download('/api/admin/' + modelName + '/export', serialize(appModel.pagingQuery), 'export');
      //   download('/api/admin/' + modelName + '/exportExcel', serialize(appModel.pagingQuery), 'exportExcel');
      //   download('/api/admin/' + modelName + '/exportSendExcel', serialize(appModel.pagingQuery), 'exportSendExcel');
      // }

    });

  });



  $('.loading-wrapper').removeClass('active');
}
