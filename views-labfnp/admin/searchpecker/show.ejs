<%- include ../chart/index.ejs %>

<%- include form.ejs %>

<!-- SCRIPTS ON PAGE EVENT -->
<script type="text/javascript">

	var pagefunction = function() {
		<%- include vue.ejs %>

		appMain.$mount("#main-edit");
		appMain.loadItem(function() {
      var chart = {};

      var updateChart = function(data) {
        chart.load(data);
      }

      loadScript("/assets/admin/js/libs/d3.js", function(){
        loadScript("/assets/admin/js/libs/c3.js", function(){
          chart = c3.generate({
             bindto: '#chart',
              data: {
                x: 'x',
                columns: [
                  appModel.data.item.recordDate,
                  appModel.data.item.rank,
                ],
                types: {
                  data1: 'area',
                },
                axes: {
                  data1: 'y'
                }
              },
              axis: {
                y: {
                  inverted: true,
                  min: 1,
                  // max: 20,
                  padding: {
                    bottom: 0
                  }
                },
                x: {
                  padding: {
                    left: 0,
                    right: 0,
                  },
                  type: 'timeseries',
                  // if true, treat x value as localtime (Default)
                  // if false, convert to UTC internally
                  localtime: false,
                  tick: {
                      format: '%Y/%m/%d'
                  }
                }
              },
              zoom: {
                enabled: true
              },
              padding: {
                right: 100,
                left: 100,
                top: 20,
              }
          });

          var stacke = c3.generate({
             bindto: '#stacke',
              data: {
                x: 'x',
                columns: [
                  appModel.data.item.recordDate,
                  appModel.data.item.rankTrend.up,
                  appModel.data.item.rankTrend.down,
                  // ['上升', null, 3, 1, null, null, 4, null, null, 1, null, null, 4, null, null],
                  // ['下降', null, null, null, -1, -3, null, null, -1, null, -1, -3, null, null, null],
                ],
                type: 'bar',
                groups: [
                  ['上升', '下降']
                ],
                labels: true,
              },
              axis: {
                x: {
                  padding: {
                    left: 0,
                    right: 0,
                  },
                  type: 'timeseries',
                  // if true, treat x value as localtime (Default)
                  // if false, convert to UTC internally
                  localtime: false,
                  tick: {
                      format: '%Y/%m/%d'
                  }
                }
              },
              zoom: {
                enabled: true
              },
              padding: {
                right: 100,
                left: 100,
                top: 20,
              },
              grid: {
                y: {
                  lines: [{value:0}]
                }
              }
          });
        });
      });
      console.log("!!!!!!", appModel.data.item.rank, appModel.data.item.recordDate);
      // updateChart({
      //   columns: [
      //     appModel.data.item.rank,
      //     appModel.data.item.recordDate,
      //   ],
      // })
    });
	};

</script>
