var COMMON = {
  DOUBLE_CLICK_TIME_PERIOD: 250,
  DEFAULT_INDEX: -1,
  DEFAULT_AVATAR: "/assets/admin/img/avatars/default.png",
};

var itemBeforeEdit = {};
var prefix = '';
var modelName = "labfnp/recipe";
var appModel = {
  modelName: modelName,
  prefix: prefix,
  data: {
    item: {
      id: '',
			authorName: '',
			perfumeName: '',
			formulaLogs: '',
			formula: [],
			totalDrops: 0,
			description: '',
			message: '',
			User: {},
			visibility: '',
			productionStatus: '',
    },
    items: [],
    option: {}
  },
  view: {
    table: {
      selectIndex: COMMON.DEFAULT_INDEX,
    },
  }
}

/* TABLETOOLS */

<%- include ../../default/vue.ejs %>
// 需要新增函式可以對 appMain 進行定義，如：
// appMain.log = function () {console.log("123")}
appMain.onEnterPageShow = function () {
	var pieHeader = {
		"title": {
			"text": "",
			"fontSize": 24,
			"font": "open sans"
		},
		"subtitle": {
			"text": "",
			"color": "#999999",
			"fontSize": 12,
			"font": "open sans"
		},
		"titleSubtitlePadding": 9
	};
	var pieFooter = {
		"color": "#999999",
		"fontSize": 10,
		"font": "open sans",
		"location": "bottom-left"
	};
	var pieSize = {
		"canvasWidth": 300,
		"canvasHeight": 400,
		"pieOuterRadius": "70%"
	};
	var pieDate = {
		"sortOrder": "value-desc",
		"content": [],
		"labels": {
			"outer": {
				"pieDistance": 32
			},
			"inner": {
				"hideWhenLessThanPercentage": 3
			},
			"mainLabel": {
				"fontSize": 11
			},
			"percentage": {
				"color": "#ffffff",
				"decimalPlaces": 0
			},
			"value": {
				"color": "#adadad",
				"fontSize": 11
			},
			"lines": {
				"enabled": true
			},
			"truncation": {
				"enabled": true
			},
		},
		"effects": {
			"pullOutSegmentOnClick": {
				"effect": "elastic",
				"speed": 400,
				"size": 8
			}
		},
		"misc": {
			"gradient": {
				"enabled": true,
				"percentage": 100
			}
		},
	};
  console.log("###########");
  console.log(appModel);
  console.log("###########");

	var formula = appModel.data.item.formula;
	for (var i = 0; i < formula.length; i++) {
		if (formula[i].drops > 0) {
			pieDate.content.push({
				label: formula[i].scent,
				value: parseInt(formula[i].drops),
				color: formula[i].color,
			});
		}
	}
	var pie = new d3pie("pieChart", {
		"header": pieHeader,
		"footer": pieFooter,
		"size": pieSize,
		"data": pieDate,
	});
	// var perfumePieConfig = {
	//     type: 'pie',
	//     data: {
	//       datasets: [{
	//         data: dropsArray,
	//         backgroundColor: scentColorArray,
	//       }],
	//       labels: labelArray,
	//     },
	//     animation:{
	//         animateScale:true,
	//     },
	//     options: {
	//       title: {
	//           display: true,
	//           text: ''
	//       },
	//       legend: {
	//           display: false,
	//       },
	//       circumference: 1.5 * Math.PI,
	//       responsive: true,
	//       hover: {
	//         mode: 'label',
	//       }
	//     }
	// };
// var perfumePie = new Chart(document.getElementById("pieChart"), perfumePieConfig);
};
