var COMMON = {
  DOUBLE_CLICK_TIME_PERIOD: 250,
  DEFAULT_INDEX: -1,
  DEFAULT_AVATAR: "/assets/admin/img/avatars/default.png",
};

var itemBeforeEdit = {};
var prefix = 'admin/';
var modelName = "config";
var appModel = {
  modelName: modelName,
  prefix: prefix,
  data: {
    item: {
      name: '',
      key: '',
      description: '',
      value: '',
      type: '',

    },
    items: [],
    option: {}
  },
  view: {
    table: {
      selectIndex: COMMON.DEFAULT_INDEX,
    },
  }
}

/* TABLETOOLS */

<%- include ../default/vue.ejs %>
// 需要新增函式可以對 appMain 進行定義，如：
// appMain.log = function () {console.log("123")}

appMain.editDisabled = function(){
  $('label.fn-edit-disabled > input').attr('disabled', true);
  $('label.fn-edit-disabled').addClass('state-disabled');
};

appMain.createHide = function () {
  $('.fn-create-hide').hide();
};

appMain.DataTableInitComplete = function()  {
  var reloadConfigBtn = '<a class="DTTT_button DTTT_button_text" id="ToolTables_main-table_custom_1" title="重新載入 Config" tabindex="0" aria-controls="main-table"><span>重新載入 Config</span></a>'
  $(reloadConfigBtn).prependTo('.DTTT_container');
  $('#ToolTables_main-table_custom_1').on('click', function() {
    $.SmartMessageBox({
      title : "重新載入 Config",
      buttons : "[取消][確定]"
    }, function(ButtonPress) {
      if(ButtonPress === '確定') {
        $.ajax({
          url: '/api/admin/config/reload',
          type: 'POST',
          success: function(result) {
            console.log(result);
            messageApp.show({
              desc: '更新 Config 成功！',
              type: 'success'
            });
            defaultTable.api().ajax.reload(null, false);
          },
          error: function(result) {
            console.log('更新失敗', result);
            messageApp.show({
              desc: '更新 Config 失敗！'+ result.responseJSON.message,
              type: 'error'
            });
          },
        });
      }
    });
  });
  $('.loading-wrapper').removeClass('active');
};
